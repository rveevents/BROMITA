<script>
const startScreen = document.getElementById("startScreen");
const terminal = document.getElementById("terminal");
let audioContext;

function goFullScreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
            console.log("Error al entrar en pantalla completa:", err);
        });
    }
}

function beep(freq = 800, duration = 0.03, volume = 0.05) {
    const oscillator = audioContext.createOscillator();
    const gain = audioContext.createGain();
    oscillator.type = "square";
    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
    gain.gain.setValueAtTime(volume, audioContext.currentTime);
    oscillator.connect(gain);
    gain.connect(audioContext.destination);
    oscillator.start();
    oscillator.stop(audioContext.currentTime + duration);
}

function typeText(text, speed = 40) {
    return new Promise(resolve => {
        let i = 0;
        function typing() {
            if (i < text.length) {
                terminal.innerHTML += text.charAt(i);
                if (text.charAt(i) !== " " && text.charAt(i) !== "\n") beep();
                i++;
                setTimeout(typing, speed);
            } else {
                terminal.innerHTML += "<br><br>";
                resolve();
            }
        }
        typing();
    });
}

function crashSound() {
    beep(60, 1, 0.4);
}

function showBSOD() {

    goFullScreen(); // ðŸ‘ˆ AquÃ­ se activa pantalla completa real

    document.body.innerHTML = `
    <div style="
        position:fixed;
        inset:0;
        background:#0078D7;
        color:white;
        font-family:Segoe UI, sans-serif;
        display:flex;
        flex-direction:column;
        justify-content:center;
        padding:80px;
        font-size:22px;">
        
        <div style="font-size:80px;">:(</div>
        <p>Tu PC ha tenido un problema y necesita reiniciarse.</p>
        <p>Estamos recopilando informaciÃ³n del error...</p>
        <br>
        <p>ERROR CODE: CRITICAL_PROCESS_DIED</p>
        <p id="percent">0% completado</p>
    </div>
    `;

    let percent = 0;
    const interval = setInterval(() => {
        percent += Math.floor(Math.random() * 10);
        if (percent >= 100) {
            percent = 100;
            clearInterval(interval);
        }
        document.getElementById("percent").innerText = percent + "% completado";
    }, 400);
}

function showBootScreen() {
    document.body.innerHTML = `
    <div style="
        position:fixed;
        inset:0;
        background:black;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        color:white;
        font-family:sans-serif;">
        
        <div style="
            width:120px;
            height:120px;
            display:grid;
            grid-template-columns:1fr 1fr;
            gap:6px;
            margin-bottom:40px;">
            <div style="background:#00A4EF;"></div>
            <div style="background:#00A4EF;"></div>
            <div style="background:#00A4EF;"></div>
            <div style="background:#00A4EF;"></div>
        </div>

        <p>Cargando sistema...</p>
    </div>
    `;
}

function showJoke() {
    document.body.innerHTML = `
    <div style="
        position:fixed;
        inset:0;
        background:black;
        color:#00ff00;
        font-family:Courier New;
        font-size:30px;
        display:flex;
        justify-content:center;
        align-items:center;">
        ES BROMA ðŸ˜­ NO ME MATES NO HICE NADA
    </div>`;
}

startScreen.addEventListener("click", async () => {
    startScreen.style.display = "none";
    audioContext = new (window.AudioContext || window.webkitAudioContext)();

    await typeText("BIENVENIDO", 60);
    await new Promise(r => setTimeout(r, 2000));

    await typeText("EXTRAYENDO IP...", 50);
    await new Promise(r => setTimeout(r, 2000));

    await typeText("INFORMACIÃ“N DETECTADA:", 50);
    await typeText("NOMBRE: DANI MARMOY", 50);
    await typeText("CIUDAD: BARCELONA, MATARÃ“", 50);
    await new Promise(r => setTimeout(r, 1500));

    crashSound();

    setTimeout(() => {
        showBSOD();
        setTimeout(() => {
            showBootScreen();
            setTimeout(() => {
                showJoke();
            }, 4000);
        }, 6000);
    }, 1000);
});
</script>
